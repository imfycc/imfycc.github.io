---
title: å¦‚ä½•ç»™ç½‘ç«™æ·»åŠ å…è´¹çš„ https è¯ä¹¦
date: 2019-11-27
updated: 2023-10-06
tags:
categories: ç¼–ç¨‹
---

{% qnimg https-config.jpg 'alt:https' %}

> 2023å¹´10æœˆ06æ›´æ–°
>
> å·²ç»å¥½ä¹…æ²¡æè¿‡ SSL è¯ä¹¦çš„ç”³è¯·äº†ï¼Œæ„Ÿè§‰æŠ˜è…¾èµ·æ¥åº”è¯¥æŒºéº»çƒ¦çš„ï¼Œç¬¬ä¸€ååº”å…ˆå»è°·æ­Œäº†ä¸€ä¸‹ã€‚ç„¶ååœ¨å‰å‡ æ¡æœç´¢é‡Œå±…ç„¶çœ‹åˆ°äº†è‡ªå·±çš„åšæ–‡ï¼Œå“ˆå“ˆå“ˆã€‚ä¸€çœ‹æ—¶é—´æ˜¯ 4 å¹´å‰å†™çš„äº†ï¼Œä½†æ˜¯æŒ‰ç…§å†…å®¹èµ°äº†ä¸€éæµç¨‹å±…ç„¶æ²¡è¿‡æ—¶ï¼Œä¾ç„¶é€‚ç”¨ï¼Œå¤ªæ„å¤–äº†ã€‚è€Œä¸”è®¾ç½®è¯ä¹¦æŒºç®€å•çš„ï¼Œæ•´ä¸ªæµç¨‹è¾“å…¥å‡ ä¸ªå‘½ä»¤å°±è‡ªåŠ¨è®¾ç½®å¥½äº†ï¼Œå…¨ç¨‹ä¸åˆ° 5 åˆ†é’Ÿã€‚So easy!
>
> certbot çš„å‘½ä»¤è‡ªåŠ¨å¸®ä½ ç”³è¯·è¯ä¹¦ã€é…ç½®åˆ° nginx ä¸Šï¼Œéƒ½ä¸éœ€è¦è‡ªå·±ä¿®æ”¹å’Œé‡å¯ nginx æœåŠ¡ã€‚æ•´ä¸ªæµç¨‹å¾ˆç®€å•ã€‚
>
> è¿™ä¹Ÿæ˜¯å†™åšæ–‡çš„å¥½å¤„å§ã€‚åšä¸ªè®°å½•ï¼Œæ–¹ä¾¿å¤§å®¶ï¼Œä¹Ÿæ–¹ä¾¿ä»¥åçš„è‡ªå·±ã€‚ğŸ˜†

ä»¥ä¸‹æ˜¯æ­£æ–‡
---

æœ€è¿‘éƒ¨ç½²äº†ä¸€ä¸ªæ–°æœåŠ¡ï¼Œæƒ³ç»™åŸŸåå¯ç”¨ `https`ï¼Œç»“æœæœäº†åŠå¤©ï¼Œåœ¨æˆ‘çš„åšå®¢é‡Œåªå‘ç°äº†è¿™ä¸€ç¯‡ç¬”è®°ï¼š[é˜¿é‡Œäº‘å…è´¹è¯ä¹¦åŸŸåå¯ç”¨ https](https://hufangyun.com/2017/https-aliyun-free/)

ğŸ˜¹ åªèƒ½è¯´ç»™ç½‘ç«™å¯ç”¨ `https` å¤ªç®€å•äº†ï¼Œä¹‹å‰éƒ½æ²¡ç•™ä¸‹ç¬”è®°ï¼Œä¸ºäº†ä¹‹åæ–¹ä¾¿ï¼Œç®€å•è®°å½•ä¸€ä¸‹ã€‚

æˆ‘ä½¿ç”¨çš„æ˜¯ [Letâ€™s Encrypt](https://letsencrypt.org/) çš„å…è´¹è¯ä¹¦ã€‚

æŒ‰ç…§ä¸‹é¢çš„æ“ä½œä¸€æ­¥æ­¥æ¥å°±è¡Œäº†ã€‚

1ã€å» [certbot](https://certbot.eff.org/) å®˜ç½‘ã€‚

2ã€åœ¨é¡µé¢ä¸Šé€‰æ‹©ä¸€ä¸‹ä½ ç”¨çš„ `Web` æœåŠ¡å™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ¯”å¦‚ï¼Œæˆ‘é€‰çš„ `Nginx` å’Œ `Ubuntu 22.04`ã€‚é€‰é¡¹é‡Œæ²¡æ‰¾åˆ° Ubuntu 22 ç‰ˆæœ¬ï¼Œæˆ‘é€‰äº†ä¸ª 20 çš„ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚

3ã€é¡µé¢ä¸Šä¼šå‡ºç°æ“ä½œæ­¥éª¤ï¼ŒæŒ‰ç…§æç¤ºçš„æ­¥éª¤ä¸€æ­¥æ­¥æ‰§è¡Œå‘½ä»¤å°±å¯ä»¥äº†ã€‚

éœ€è¦æ³¨æ„æ‰§è¡Œåˆ° `sudo certbot --nginx` çš„æ—¶å€™ï¼Œä¼šå‡ºç°ä¸¤ä¸ªåè®®ï¼š

ç¬¬ä¸€ä¸ªï¼Œæ˜¯é—®ä½ è¦ä¸è¦åŒæ„ä»–ä»¬çš„æœåŠ¡åè®®ï¼Œé€‰æ‹©â€œåŒæ„â€ã€‚

ç¬¬äºŒä¸ªï¼Œæ˜¯é—®ä½ è¦ä¸è¦å…±äº«ä½ çš„é‚®ç®±ç»™ä»–ä»¬ï¼Œä»–ä»¬å¶å°”ä¼šå‘ä¸€äº›ä»–ä»¬åŸºé‡‘ä¼šçš„æ–°é—»ä¸€ç±»çš„ã€‚æˆ‘é€‰äº†â€œä¸åŒæ„â€ï¼ˆå› ä¸ºæˆ‘ä¸çŸ¥é“ä»¥åæœ‰æ²¡æœ‰é€€è®¢é€‰é¡¹ ğŸ˜‚ï¼‰ã€‚

ä¹‹å `certbot` ä¼šè‡ªåŠ¨æ‰«æä½ çš„ `Nginx` çš„é…ç½®ï¼Œå¯»æ‰¾åŸŸååˆ—è¡¨ç„¶åè®©ä½ é€‰æ‹©æƒ³é…ç½® `https` è¯ä¹¦çš„åŸŸåï¼ˆå¥½åƒå¯ä»¥åŒæ—¶é…ç½®å¤šä¸ªåŸŸåï¼‰ã€‚

å¦‚æœæ²¡æ‰¾åˆ°åŸŸåçš„è¯ï¼Œä¼šè®©ä½ æ‰‹åŠ¨è¾“å…¥ä¸€ä¸ªåŸŸåã€‚

ä¹‹åä¼šé—®ä½ ï¼Œè¦ä¸è¦å¼ºåˆ¶æŠŠ `http` çš„é“¾æ¥è·³è½¬åˆ° `https` ä¸Šï¼Œå½“ç„¶é€‰â€œæ˜¯â€äº†ã€‚

ä¹‹å `certbot` ä¼šå¸®ä½ æŠŠ `Nginx` ä¸€åˆ‡éƒ½é…ç½®å¥½ã€‚ä½ ç›´æ¥è®¿é—®åŸŸåçœ‹ä¸€ä¸‹æ•ˆæœå³å¯ã€‚æœåŠ¡çœŸæ˜¯ç›¸å½“çš„è´´å¿ƒã€‚ã€‚ã€‚ã€‚ğŸ‰

è€—å”çš„è¿™ç¯‡æ–‡ç«  [å¦‚ä½•å…è´¹çš„è®©ç½‘ç«™å¯ç”¨HTTPS|é…· å£³ - CoolShell](https://coolshell.cn/articles/18094.html) æåˆ°é…ç½®`http2` ä¼ è¾“æ€§èƒ½æ›´å¥½ã€‚

> è¦æ±‚ `Nginx` ç‰ˆæœ¬è¦å¤§äº `1.9.5`ã€‚`HTTP2` å…·æœ‰æ›´å¿«çš„ `HTTPS` ä¼ è¾“æ€§èƒ½ï¼Œéå¸¸å€¼å¾—å¼€å¯ã€‚éœ€è¦å¼€å¯ `HTTP/2` å…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨ `nginx.conf` çš„ `listen 443 ssl;` åé¢åŠ ä¸Š `http2` å°±å¥½äº†ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š

```nginx
listen 443 ssl http2; # managed by Certbot 
ssl_certificate /etc/letsencrypt/live/coolshell.cn/fullchain.pem; # managed by Certbot 
ssl_certificate_key /etc/letsencrypt/live/coolshell.cn/privkey.pem; # managed by Certbot 
include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
```
ç„¶åï¼Œ`nginx -s reload` å°±å¥½äº†ã€‚